"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function fpsFilter(format, options) {
    return !options.maxFps || format.fps <= options.maxFps;
}
function resolutionFilter(format, options) {
    return !options.maxResolution || format.resolution <= options.maxResolution;
}
function audioBitrateFilter(format, options) {
    return !options.maxAudioBitrate || format.audioBitrate <= options.maxAudioBitrate;
}
function fpsSort(a, b) {
    return (b.fps || 0) - (a.fps || 0);
}
function resolutionSort(a, b) {
    return (b.resolution || 0) - (a.resolution || 0);
}
function audioBitrateSort(a, b) {
    return (a.audioBitrate || 0) - (b.audioBitrate || 0);
}
function extendPreset(base, overrides) {
    return Object.assign({}, base, overrides);
}
const baseVideoPreset = {
    name: null,
    maxResolution: Number.MAX_SAFE_INTEGER,
    maxFps: 60,
    videoFilters: [resolutionFilter, fpsFilter],
    videoSort: [resolutionSort, fpsSort],
    audioSort: [audioBitrateSort],
    maxAudioBitrate: 128
};
exports.baseAudioPreset = {
    name: null,
    audioFilters: [audioBitrateFilter],
    audioSort: [audioBitrateSort],
    maxAudioBitrate: 128
};
exports.maxPreset = {
    name: 'max',
    maxFps: Number.MAX_SAFE_INTEGER,
    maxResolution: Number.MAX_SAFE_INTEGER,
    maxAudioBitrate: Number.MAX_SAFE_INTEGER
};
const fourKPreset = {
    name: '4k',
    maxResolution: 2160
};
const twoKPreset = {
    name: '2k',
    maxResolution: 1440
};
const hdPreset = {
    name: 'hd',
    maxResolution: 1080
};
const sdPreset = {
    name: 'sd',
    maxResolution: 720
};
const ldPreset = {
    name: 'ld',
    maxResolution: 480
};
const hfrPreset = {
    name: 'hfr',
    maxFps: Number.MAX_SAFE_INTEGER,
    maxResolution: Number.MAX_SAFE_INTEGER,
    videoSort: [fpsSort, resolutionSort]
};
const mp3Preset = {
    name: 'mp3',
    outputFormat: 'mp3',
    maxAudioBitrate: Number.MAX_SAFE_INTEGER
};
function prepPreset(preset) {
    if (!preset.maxResolution && !preset.maxAudioBitrate) {
        throw new Error(`Custom presets must have at least a maxAudioBitrate or maxResolution`);
    }
    if (!preset.maxResolution) {
        preset = extendPreset(exports.baseAudioPreset, preset);
    }
    else {
        preset = extendPreset(baseVideoPreset, preset);
    }
    return preset;
}
exports.prepPreset = prepPreset;
exports.DefaultPresets = [exports.maxPreset, fourKPreset, twoKPreset, hdPreset, sdPreset, ldPreset, hfrPreset, mp3Preset];
exports.Presets = {
    Max: exports.maxPreset.name,
    FourK: fourKPreset.name,
    TwoK: twoKPreset.name,
    HD: hdPreset.name,
    SD: sdPreset.name,
    LD: ldPreset.name,
    HFR: hfrPreset.name,
    MP3: mp3Preset.name
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlc2V0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvcHJlc2V0cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUdBLFNBQVMsU0FBUyxDQUFFLE1BQW1CLEVBQUUsT0FBZTtJQUN0RCxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsR0FBRyxJQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDekQsQ0FBQztBQUNELFNBQVMsZ0JBQWdCLENBQUUsTUFBbUIsRUFBRSxPQUFlO0lBQzdELE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxJQUFJLE1BQU0sQ0FBQyxVQUFVLElBQUksT0FBTyxDQUFDLGFBQWEsQ0FBQztBQUM5RSxDQUFDO0FBQ0QsU0FBUyxrQkFBa0IsQ0FBRSxNQUFtQixFQUFFLE9BQWU7SUFDL0QsT0FBTyxDQUFDLE9BQU8sQ0FBQyxlQUFlLElBQUksTUFBTSxDQUFDLFlBQVksSUFBSSxPQUFPLENBQUMsZUFBZSxDQUFDO0FBQ3BGLENBQUM7QUFFRCxTQUFTLE9BQU8sQ0FBQyxDQUFjLEVBQUUsQ0FBYztJQUM3QyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDckMsQ0FBQztBQUNELFNBQVMsY0FBYyxDQUFDLENBQWMsRUFBRSxDQUFjO0lBQ3BELE9BQU8sQ0FBQyxDQUFDLENBQUMsVUFBVSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUNuRCxDQUFDO0FBQ0QsU0FBUyxnQkFBZ0IsQ0FBQyxDQUFjLEVBQUUsQ0FBYztJQUN0RCxPQUFPLENBQUMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxZQUFZLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkQsQ0FBQztB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